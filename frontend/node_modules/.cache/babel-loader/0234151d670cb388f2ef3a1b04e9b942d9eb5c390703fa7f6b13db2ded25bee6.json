{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useContext } from 'react';\nimport { AuthContext } from '../contexts/AuthContext';\nconst useSignup = () => {\n  _s();\n  const [error, setError] = useState({});\n  const [displayFlash, setDisplayFlash] = useState(false);\n  const {\n    authDispatch\n  } = useContext(AuthContext);\n  async function handleSubmit(event) {\n    event.preventDefault();\n    setDisplayFlash(false);\n    event.target[event.target.length - 1].disabled = true;\n    setError({});\n    let copyErr = {};\n    let copyVal = {};\n    for (let i = 0; i < event.target.length - 1; i++) {\n      const name = event.target[i].name;\n      const value = event.target[i].value.trim();\n      copyVal[name] = value;\n      if (!value) copyErr[name] = \"This field cannot be left blank\";else {\n        switch (name) {\n          case \"email\":\n            if (!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/.test(value)) copyErr[\"email\"] = \"Invalid email format\";\n            break;\n          case \"password\":\n            let errString = \"\";\n            if (!/[A-Z]/.test(value)) errString += \"Password must have one uppercase letter\\n\";\n            if (!/[a-z]/.test(value)) errString += \"Password must have one lowercase letter\\n\";\n            if (!/[0-9]/.test(value)) errString += \"Password must have one digit\\n\";\n            if (!/[!@#$%]/.test(value)) errString += \"Password must have one special character (!, @, #, $, %)\\n\";\n            if (value.length < 8) errString += \"Pasword must be more than 8 characters long\";\n            if (errString) copyErr['password'] = errString.trim();\n            break;\n          case \"yearOfBirth\":\n            const curr_year = new Date().getFullYear();\n            if (!(curr_year - 100 < +value && curr_year - 15 > +value)) copyErr['yearOfBirth'] = \"Year of birth out of valid range\";\n            break;\n          default:\n            break;\n        }\n      }\n    }\n    if (Object.keys(copyErr).length === 0) {\n      try {\n        const res = await fetch(\"http://localhost:2000/user/signup/\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify(copyVal)\n        });\n        if (res.ok) {\n          const {\n            id,\n            token\n          } = await res.json();\n          authDispatch({\n            type: \"login\",\n            payload: {\n              token\n            }\n          });\n          setDisplayFlash(true);\n          event.target.reset();\n        } else throw res;\n      } catch (err) {\n        const genErr = await err.json();\n        console.log(genErr);\n        copyErr[\"general\"] = genErr.message;\n        setError(copyErr);\n      }\n    } else {\n      setError(copyErr);\n    }\n    event.target[event.target.length - 1].disabled = false;\n  }\n  return {\n    error,\n    handleSubmit,\n    displayFlash\n  };\n};\n_s(useSignup, \"Kjjbh6rw+mOp+19xqKN7b/bQ900=\");\nexport default useSignup;","map":{"version":3,"names":["useState","useContext","AuthContext","useSignup","_s","error","setError","displayFlash","setDisplayFlash","authDispatch","handleSubmit","event","preventDefault","target","length","disabled","copyErr","copyVal","i","name","value","trim","test","errString","curr_year","Date","getFullYear","Object","keys","res","fetch","method","headers","body","JSON","stringify","ok","id","token","json","type","payload","reset","err","genErr","console","log","message"],"sources":["C:/Users/Tejasw/Desktop/project/frontend/src/hooks/useSignup.jsx"],"sourcesContent":["import {useState, useContext} from 'react'\r\nimport {AuthContext} from '../contexts/AuthContext'\r\n\r\nconst useSignup = ()=>{\r\n\r\n    const [error, setError] = useState({})\r\n    const [displayFlash, setDisplayFlash] = useState(false)\r\n    const {authDispatch} = useContext(AuthContext)\r\n\r\n    async function handleSubmit(event){\r\n        event.preventDefault()\r\n        setDisplayFlash(false)\r\n        event.target[event.target.length-1].disabled = true\r\n        setError({})\r\n        let copyErr = {}\r\n        let copyVal = {}\r\n        for(let i=0; i<event.target.length-1; i++){\r\n            const name = event.target[i].name\r\n            const value = event.target[i].value.trim()\r\n            copyVal[name] = value\r\n            if(!value)\r\n                copyErr[name] = \"This field cannot be left blank\"\r\n            else{\r\n                switch(name){\r\n                    case \"email\":\r\n                        if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/.test(value))\r\n                            copyErr[\"email\"] = \"Invalid email format\"\r\n                        break;\r\n                    case \"password\":\r\n                        let errString = \"\"\r\n                        if(!/[A-Z]/.test(value)) errString+=\"Password must have one uppercase letter\\n\"\r\n                        if(!/[a-z]/.test(value)) errString+=\"Password must have one lowercase letter\\n\"\r\n                        if(!/[0-9]/.test(value)) errString+=\"Password must have one digit\\n\"\r\n                        if(!/[!@#$%]/.test(value)) errString+=\"Password must have one special character (!, @, #, $, %)\\n\"\r\n                        if(value.length<8) errString+=\"Pasword must be more than 8 characters long\"\r\n                        if(errString)\r\n                            copyErr['password'] = errString.trim()\r\n                    break;\r\n                    case \"yearOfBirth\":\r\n                        const curr_year = new Date().getFullYear()\r\n                        if (!(curr_year-100 < +value && curr_year-15 > +value))\r\n                            copyErr['yearOfBirth'] = \"Year of birth out of valid range\"\r\n                    break;\r\n                    default:\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if(Object.keys(copyErr).length===0){\r\n            try{\r\n                const res = await fetch(\"http://localhost:2000/user/signup/\",{\r\n                    method: \"POST\",\r\n                    headers: {\"Content-Type\": \"application/json\"},\r\n                    body: JSON.stringify(copyVal)\r\n                })\r\n                if(res.ok){\r\n                    const {id, token} = await res.json()\r\n                    authDispatch({type:\"login\", payload:{token}})\r\n                    setDisplayFlash(true)\r\n                    event.target.reset()\r\n                }\r\n                else\r\n                    throw res\r\n            }\r\n            catch(err){\r\n                const genErr = await err.json()\r\n                console.log(genErr)\r\n                copyErr[\"general\"] = genErr.message\r\n                setError(copyErr)\r\n            }\r\n        }\r\n        else{\r\n            setError(copyErr)\r\n        }\r\n        event.target[event.target.length-1].disabled = false\r\n    }\r\n\r\n    return({\r\n        error,\r\n        handleSubmit,\r\n        displayFlash\r\n    })\r\n\r\n}\r\n\r\nexport default useSignup"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}